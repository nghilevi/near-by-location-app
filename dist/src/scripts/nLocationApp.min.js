/*! nLocationApp 23-07-2015 */
angular.module("nearByLocationApp",["ngAnimate","ngRoute","appControllers","appServices","appDirectives"]).config(function(a){a.when("/",{templateUrl:"src/views/listView.html",controller:"listViewCtrl"}).otherwise({templateUrl:"src/views/404.html"})}),angular.module("appConstants",[]).constant("clientConst",{CLIENT_ID:"CYEMKOM4OLTP5PHMOFVUJJAMWT5CH5G1JBCYREATW21XLLSZ",CLIENT_SECRET:"GYNP4URASNYRNRGXR5UEN2TGTKJHXY5FGSAXTIHXEUG1GYM2",CLIENT_VERSION:"20150408",ZERO_RESULT:{name:"No results found",distance:"",address:"Please type in another search terms"},ERROR:{name:"Something's wrong !!!",distance:"",address:"Please wait/refresh the page, make sure you've provided secret ID and select 'Share Location'"},UNIT:"m"}),angular.module("appControllers",["appServices"]).controller("listViewCtrl",function(a,b,c){a.venueList=[];var d;a.search=function(e){a.loading=!0,c.cancel(d),d=c(function(){b.search(e).then(function(b){a.venueList=b})["finally"](function(){a.loading=!1})},500)}}),angular.module("appDirectives",["appFilters"]).directive("venueItem",function(){return{restrict:"E",scope:{venue:"="},link:function(a){},template:'<a ng-href="{{venue.location | googleMapLink}}" target="_blank">\n  <li class="info">\n    <h3 class="name">{{venue.name}}{{venue.distance | venueDistance}}</h3>\n    <p class="address">{{venue.address}}</p>\n  </li>\n</a>'}}),angular.module("appFilters",["appConstants"]).filter("venueDistance",function(a){return function(b){return b?" - "+b+a.UNIT+" away":""}}).filter("googleMapLink",function(a){return function(a){return a?"http://maps.google.com/?q="+a:""}}),angular.module("appServices",["appConstants","geolocation"]).value("baseUrlBuilder",{baseUrl:"",id:function(a){return this.baseUrl+="?client_id="+a,this},secret:function(a){return this.baseUrl+="&client_secret="+a,this},version:function(a){return this.baseUrl+="&v="+a,this},geoData:function(a){return this.baseUrl+="&ll="+a.coords.latitude+","+a.coords.longitude+"&query=",this},get:function(){return this.baseUrl},init:function(){return this.baseUrl="https://api.foursquare.com/v2/venues/search",this}}).factory("fSBaseUrl",function(a,b,c){function d(){return a.getLocation().then(function(a){b.CLIENT_SECRET&&(e=c.init().id(b.CLIENT_ID).secret(b.CLIENT_SECRET).version(b.CLIENT_VERSION).geoData(a).get())}),e}var e;return d(),{getBaseURL:function(){return e?e:d()}}}).factory("searchService",function(a,b,c,d){function e(a){return a.data}function f(a,b){a=angular.fromJson(a);var c,e=a.response.venues;return c=0!=e.length?e.map(function(a){return{location:a.location.lat+","+a.location.lng,name:a.name,distance:a.location.distance,address:(a.location.address||"")+" "+(a.location.city||"")}}):[d.ZERO_RESULT]}var g=function(g){var h=c.getBaseURL();return h?a.get(h+g,{transformResponse:f}).then(e):b.resolve([d.ERROR])};return{search:g}});